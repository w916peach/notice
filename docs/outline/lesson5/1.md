# 知识点(服务端开发)

## 课程引导

### javaScript可以用来做什么

1. 最初，js被用来在浏览器端实现表单的验证。
2. 在浏览器端可以使用js操作dom实现各种各样的效果和动画。
3. 浏览器端的js可以处理数据，实现各种页面功能。
4. 可以使用JavaScript发出http请求，实现各种交互任务

**以上，是浏览器中js的功能。换句话说，就是JavaScript脱离了浏览器，上述功能也就不存在了。**

**当然，浏览器也会对JavaScript有一些限制，比如一些常见的文件操作，系统接口的调用，数据库连接等等这些功能都无法实现**

于是在2009年，Ryan正式推出了基于JavaScript语言和V8引擎的开源Web服务器项目，命名为Node.js。虽然名字很土，但是，Node第一次把JavaScript带入到后端服务器开发，加上世界上已经有无数的JavaScript开发人员，所以Node一下子就火了起来。

正是因为node的出现，我们的JavaScript才可以脱离浏览器去运行，当然也没有了浏览器的一些限制了。同样的，在浏览器的部分功能也就不存在了，比如：操作dom！

**那么运行在node上的JavaScript可以做什么呢？**

1. 可以制作命令行工具（所谓命令行工具就是通过dos命令来操作的软件）
2. 可以做服务端的开发 （基于node可以开发服务器应用，就像php一样。。。）


### node的重要性

1. 它很火-从2009年nodejs诞生以来，社区为node提供的模块已经超过了15万个，并且在持续增长。而且每个月有维持在6亿多的下载量
2. 它很强-众多应用的开发都会使用到nodejs

![强](./img/1.png)

### nodejs是什么

1. nodejs是一款软件，就像qq一样，qq提供给我们的功能是交友，聊天。而node的功能就是去执行JavaScript程序。
2. 在使用方式上，会有一些区别，使用qq我们通过鼠标的点击就可以操作了。但是node是通过命令行去操作的。

**所以，nodejs其实就是为JavaScript提供运行环境的一款软件（windows版本，linux版本，mac版本）**


## 了解web架构

### 什么是web？

web就是我们常见的www（world wide web），中文名字叫万维网。

所以万维网跟我们所学习的html，css，js有什么关系呢？

![万维网](./img/4.png)

总结一下：
- web就是www，万维网
- www（web）是互联网的一个方面。
- www是由网站构成的，网站又有网页构成的，网页又分为html、css和js

### web由哪些构成？

所谓的网站，就是一种服务。
我们可以把web看成是由两个部分组成的
- 服务端
- 浏览器端

看下图：
![bs](./img/5.png)

这种架构，就称之为B/S架构。

所谓的Server，就是性能比较强悍、价格比较昂贵的计算机，在计算器中安装了相应的一些软件，运行这些软件，为用户提供相应的服务。
针对真实的server，一般来说，不需要显示器，并且是长期运行的。

常见的服务器如下图：

![server](./img/6.png)

B/S和C/S是相对的。
在软件开发领域中，就存在两种架构：
- C/S架构，Client/Server，传统的软件形式，需要在用户的计算机中安装一个客户端软件，然后才可以去使用这个服务，比如qq、杀毒软件、游戏、办公软件
- B/S架构，Browser/Server，就是现在所有的webapp，通过浏览器来访问的

对比一下这两种架构

√ | C/S | B/S
-|-|-
使用层面  |	需要安装特定的客户端软件  |	只需要有浏览器即可
维护更新 |	客户端软件需要重新下载安装 |	打开浏览器永远都是最新的
用户体验 |	更为流畅，反应更迅速 |	不流畅，经常卡顿
性能 |	性能优  胖客户端/瘦服务端 |	性能稍弱  瘦客户端/胖服务端

随着互联网的发展，主要有两个方面

- 带宽的增加
- 开发技术的创新

未来的趋势就是B/S架构。
所以，有越来越多的软件，逐渐的从C/S模式开始转变为B/S模式。

其实，移动端也是这种趋势。
- 原生的app应用，就好比是C/S模式
- 基于h5的webapp，就好比是B/S模式

### web如何为用户提供服务的？（重点）

作为一名web开发人员，必须要搞清楚这个流程。
请问：
1. 淘宝网站是如何为用户提供服务的?
2. 在百度中输入搜索关键字，然后返回了页面，这中间发生了哪些动人的故事?

大致的流程如下：

![服务流程图](./img/7.png)

整个流程包括三个方面：
- 浏览器端：html、css和js
- 服务端：web服务器、后端语言、数据库
- 浏览器端和服务端端通信：HTTP

其中，需要注意，我们说的浏览器端，是指浏览器会获取从服务器端返回的html、css和js，然后进行解析的。

转变一个思维：我们平常开发的静态页面和app，最终是需要放到服务器端，然后用户在访问的时候，会将这些页面的html、css和js下载到自己的浏览器的内存中，然后进行解析渲染。

返回的过程，可以通过network面板来进行查看。

## nodejs快速入门

### 再谈客户端JavaScript

有如下几个问题：
- 什么是JavaScript？
- JavaScript的运行环境是？
- 浏览器中的JavaScript 可以做什么？
- 浏览器中的JavaScript 不可以做什么？
- JavaScript只可以运行在浏览器中吗？
- 编程语言的能力取决于什么？

1. 什么是JavaScript？
Javascript是一门运行在浏览器端的脚本语言。
两大方面：
    - 在浏览器端运行的（还有在服务端运行的，比如php）
    - 脚本语言，嵌入到其他的语言中（插入到html中）


2. JavaScript的运行环境是？
就是浏览器。

3. 浏览器中的JavaScript 可以做什么？
在浏览器端，主要是使用js来实现DOM操作。
    - 表单验证
    - 实现一些特性和动画
    - 更好的组织页面的结构（tab选项卡、轮播图）
    - 可以使用ajax来提升用户体验
    - 页游

4. 浏览器中的JavaScript 不可以做什么？
作为一门编程语言，js和其他语言相比，它不能干什么？
其他语言，比如c、c++、c#、java、php等
js不能做的事情如下：
    - 文件操作
    - 网络编程
    - os相关操作
    - 数据库操作
    - ...

所以，我们发现，作为一门编程，居然有很多事情都不能做？
所以，这正是过去js被人鄙视的原因。认为就是js是一门玩具式的语言。

5. JavaScript只可以运行在浏览器中吗？
在09年以前，基本上只能在浏览器中运行的。
但是09年之后，情况发生了变化。

Javascript除了在浏览器中运行，它还可以在其他环境运行，比如服务端。

6. 编程语言的能力取决于什么？
其实，各门语言的功能大同小异，基本都具备下面这些内容：
    - 变量和常量
    - 数据类型
    - 表达式
    - 语句（顺序、分支、循环）
    - 函数
    - 类和对象
    - 继承

编程语言的能力取决于它所运行的环境（平台）。
舞台有多大，人的潜力就有多大。

不同的语言，有不同的运行环境。
Java最强，因为有虚拟机，就可以在任何操行系统上执行。
C#局限性有点强，因为它只能运行在windows操作系统的.net环境中
C，可以在任何os中运行。

Js也不例外，过去之所以弱，就是由于它的运行环境很单一，只是浏览器。
但是现在不一样了，在服务端环境中也可以执行的。

自此，js是大放异彩。
如果说有一门语言，会统治服务端开发、浏览器端开发、app开发，这门语言一定是js

### 什么是node.js？

官网：https://nodejs.org/en/

Node.js® is a JavaScript runtime built on Chrome's V8 JavaScript engine. Node.js uses an event-driven, non-blocking I/O model that makes it lightweight and efficient. Node.js' package ecosystem, npm, is the largest ecosystem of open source libraries in the world.

中文网站：http://nodejs.cn/

- Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境。 
- Node.js 使用了一个事件驱动、非阻塞式 I/O 的模型，使其轻量又高效。 
- Node.js 的包管理器 npm，是全球最大的开源库生态系统。

记住一点：node.js其实一个运行环境，和浏览器是同等地位。
并且，node.js这个运行环境是基于chrome v8引擎的，说明在浏览器端写的那些和浏览器环境无关的代码，在node.js中，也是同样支持的。

有很多初学者认为：node.js是一门语言，这是极其错误的。

**node.js和javascript到底是什么关系呢？**

回顾js的历史：
- 94年，livescript
- 95年，javascript
- 后来交给了一个机构----ECMA，其实将js进行了标准化---ECMAScript规范

- 1999年-2009年叫 ECMAScript3.0
- 2009年-2015年叫 ECMAScript5.0
- 16年至今叫 ECMAScript 6

所以，过去js有两个名称：
- ECMAScript版本号 （官方）
- Javascript（民间）

以前，两种叫法没啥区别。都是在浏览器端来执行的脚本语言。
但是，随着node.js的出现，其实ECMAScript 和 javascript是有区别的，
ECMAScript才是语言本身。

![js](./img/8.png)

### nodejs可以做什么？

使用Node.js可以轻松的进行服务器端应用开发，PHP、Python、Ruby能做的事情Node.js几乎都能做，而且在某些方面可以做的更好。

世界上70%以上的网站都是使用php来做的。
世界上100%的网站都使用了js。

具体来说，体现在两个方面：
- webapp（网站）
- 命令行（包括命令行工具和交互式终端程序）

其中，我们的重点是放在webapp上面。
越来越多的网站，都开始大面积的使用node.js
- 阿里（天猫）
- uber
- Yahoo
- Paypal
- Group on

既然已经有了PHP等后台语言，为何还需要Node.js？
- io密集型 --- 异步io操作
- 实时web应用 ---- socket.io

io是指input/output，输入和输出，文件操作。
实时web应用：双十一、12306、游戏、在线客服/咨询

大家需要明白，一个大型的软件，通常是结合各种技术来实现的，并不会使用单一的技术。
比如，阿里用到了php、java、c++、node.js这几种语言，数据库就使用了mysql、oracle、mongodb、redis等数据库。

### 学习nodejs的必要性

- 高薪资
- 企业的需求
- 更好的理解js语言
- 紧跟潮流

Node.JS超越jQuery成为Github上第二受欢迎的开源项目
GitHub公布10大热门编程语言：Javascript居首

https://www.npmjs.com/enterprise

下图是nodejs的下载量：
![下载量](./img/9.png)

### nodejs的特点

- 单线程
- 异步式I/O
- 事件驱动机制
- 跨平台

其实，这些特点是js本身的，只不过在node.js中表现尤为突出。

### node.js的下载及安装

1. 下载

官网下载地址：https://nodejs.org/en/download/
中文下载地址：http://nodejs.cn/download/

LTS：Long Term Support，长效版，长期支持的版本，通常是3年。

![node下载](./img/10.png)

2. 安装

以windows操作系统为例
是一个典型的windows应用程序的安装，和qq是一样的。
主要有两点：
- 装在哪儿
- 怎么装，有何细节

爱装哪儿装哪儿，建议使用默认的安装路径，放在c盘。
安装的时候，一路next下去，不用做任何的额外设置，装完即可。

安装过程，略过....
安装完成之后，可以查看其版本号：

![版本号](./img/11.png)

如果没有看到这个结果，说明安装失败了，重新安装即可。

### Node.js初体验

现在，就可以编写服务端的js代码了

#### REPL环境及Hello，world程序

所谓的REPL，就是指 交互式解释器环境，read-eval-print-loop
交互式解释器会读取输入内容并对它求值,再返回结果并输出，然后重复此过程。

浏览器的console控制台，就是一个简单的REPL环境。

![console](./img/12.png)

实际上，很多的软件/工具，都提供了这个REPL环境。
Node.js也提供了这么一个REPL环境。

在cmd窗口中，输入node，按下回车，就进入了一个REPL环境，如下：

![repl](./img/13.png)

在这个REPL环境中，可以编写任何服务端的js代码，并执行。

![aaa](./img/14.png)

这个过程，和在浏览器控制台的REPL环境中，是一模一样的。

![browser](./img/15.png)


再来看一个代码

![a](./img/16.png)

在node环境中

![](./img/17.png)


说明还是有区别的。
Node.js和浏览器都是js的运行环境，可以执行ecmascript代码。但是，两个平台有各自的api，浏览器有DOM和BOM，node.js没有这些，node.js有path、http、url、os等，浏览器是没有这些的。

alert是window对象的方法，window对象是BOM对象中的。它只能在浏览器环境中存在，在node.js环境中是不可访问的。

而console是指控制台对象，在浏览器和node.js中均有实现，都可以使用。

要退出REPL环境，只需要按ctrl+c两次。

### 输出一个九九乘法表

这个程序，是纯粹的js代码，可以在多个环境中执行。
由于这个代码比较长，不适合直接在REPL环境中来编写。

可以使用编辑器，创建文件并编写，编写完之后再执行。

### 创建一个http服务

## 不得不了解的js特性



